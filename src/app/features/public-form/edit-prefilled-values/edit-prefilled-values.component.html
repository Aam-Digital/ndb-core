<p i18n class="component-info">
  You can configure some fields to be always be set to a certain value when this
  form is submitted. For example, make a "status" field always be set to "new"
  so that you can easily filter the new records submitted by external users; or
  make a "signed up on" date field to always show the current date. If you add
  the same field(s) in the "Configure Fields" section to show to the user, this
  pre-filled value can be changed by the person filling the form.
</p>

<div class="defaultvalue-container" [class.disabled]="formControl.disabled">
  <form [formGroup]="prefilledValueSettings">
    <div formArrayName="prefilledValue">
      <div
        *ngFor="let fieldGroup of prefilledValues.controls; let i = index"
        [formGroupName]="i"
      >
        <div class="flex-row justify-space-between align-center container">
          <div class="flex-row align-center width-1-2">
            <mat-form-field class="full-width-field">
              <mat-label i18n>Field</mat-label>
              <app-entity-field-select
                [entityType]="entityConstructor"
                formControlName="field"
              />
            </mat-form-field>
            <app-help-button
              text="Select a field for which you want to set a default value."
              i18n-text
            ></app-help-button>
          </div>
          <app-default-value-options
            [value]="fieldGroup.get('defaultValue').value"
            (valueChange)="fieldGroup.get('defaultValue').setValue($event)"
            [entityType]="entityConstructor"
          ></app-default-value-options>

          <button
            mat-icon-button
            (click)="removeRestrictedPrefilled(i)"
            matTooltip="Remove default value"
            i18n-matTooltip
          >
            <fa-icon icon="trash"></fa-icon>
          </button>
        </div>
      </div>
    </div>
  </form>

  <div class="add-new-defaultvalue-field">
    <button
      mat-stroked-button
      class="add-new-defaultvalue-button"
      color="accent"
      (click)="addRestrictedPrefilled()"
      [disabled]="isAddDisabled"
      matTooltip="Add a fixed value for another field"
      i18n-matTooltip
    >
      <fa-icon aria-label="add element" icon="plus-circle"></fa-icon>
      <span i18n class="new-defaultvalue-rule">Add pre-filled value</span>
    </button>
  </div>
</div>
