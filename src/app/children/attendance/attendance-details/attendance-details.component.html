<!--
  ~     This file is part of ndb-core.
  ~
  ~     ndb-core is free software: you can redistribute it and/or modify
  ~     it under the terms of the GNU General Public License as published by
  ~     the Free Software Foundation, either version 3 of the License, or
  ~     (at your option) any later version.
  ~
  ~     ndb-core is distributed in the hope that it will be useful,
  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~     GNU General Public License for more details.
  ~
  ~     You should have received a copy of the GNU General Public License
  ~     along with ndb-core.  If not, see <http://www.gnu.org/licenses/>.
  -->


<h2 mat-dialog-title>Attendance of <app-child-block [entityId]='entity.student'></app-child-block> for {{entity.month | date:'MM/yyyy' }}:
  {{entity.getAttendancePercentage() | percent:'1.0-0'}}</h2>

<form #recordForm="ngForm">
  <mat-dialog-content>
    <div fxLayout='row wrap' fxLayoutGap='20px'>
      <div fxFlex>
        <mat-form-field>
          <input matInput placeholder="Month" name="month" type="month"
                 [valueAsDate]="entity.month" (change)='entity.month=$event.target.valueAsDate;recordForm.form.markAsDirty();'>
        </mat-form-field>
      </div>
      <div fxFlex>
        <mat-form-field>
          <mat-label>
            Type/Institution
          </mat-label>
          <mat-select name="institution" [(ngModel)]="entity.institution">
            <mat-option value="school">School</mat-option>
            <mat-option value="coaching">Coaching</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>

    <div fxLayout='row wrap' fxLayoutGap='20px' class="w-{{entity.getWarningLevel()}}">
      <mat-form-field fxFlex>
        <input matInput type="number" min="0" placeholder='Working Days'
               [value]='entity.daysWorking' (change)="entity.daysWorking=$event.target.valueAsNumber;recordForm.form.markAsDirty();">
      </mat-form-field>

      <mat-form-field fxFlex>
        <input matInput type="number" min="0" placeholder='Attended Days'
               [value]='entity.daysAttended' (change)="entity.daysAttended=$event.target.valueAsNumber;recordForm.form.markAsDirty();">
      </mat-form-field>

      <mat-form-field fxFlex>
        <input matInput type="number" min="0" placeholder='Excused Days'
               [value]='entity.daysExcused' (change)="entity.daysExcused=$event.target.valueAsNumber;recordForm.form.markAsDirty();">
      </mat-form-field>
    </div>

    <div>
      <mat-form-field class='input-max'>
        <textarea matInput placeholder="Remarks" name="remarks" [(ngModel)]="entity.remarks"></textarea>
      </mat-form-field>
    </div>

    <div>
      <app-attendance-days [attendanceMonth]='entity'></app-attendance-days>
    </div>

  </mat-dialog-content>

  <mat-dialog-actions>
    <button mat-stroked-button [disabled]='!recordForm.form.dirty' (click)='save()'>Save</button>
    <button mat-stroked-button (click)='cancel()'>Cancel</button>
  </mat-dialog-actions>
</form>
