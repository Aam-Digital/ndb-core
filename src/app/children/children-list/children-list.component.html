<h1>Children List</h1>

<div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="space-between">

  <div>
    <div>
      <mat-form-field>
        <input matInput placeholder="Filter" (ngModelChange)="applyFilter($event)" [(ngModel)]="filterString">
        <button mat-icon-button *ngIf="filterString" matSuffix aria-label="Clear" (click)="filterString=''; applyFilter('');">
          <mat-icon fontIcon="fa-times"></mat-icon>
        </button>
      </mat-form-field>
    </div>

    <table mat-table [dataSource]="childrenDataSource" matSort class="mat-elevation-z8 table-list">
      <ng-container matColumnDef="pn">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> PN </th>
        <td mat-cell *matCellDef="let child"> {{child.pn}} </td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
        <td mat-cell *matCellDef="let child"> {{child.name}} </td>
      </ng-container>

      <ng-container matColumnDef="age">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Age </th>
        <td mat-cell *matCellDef="let child"> {{child.getAge()}} </td>
      </ng-container>

      <ng-container matColumnDef="class">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Class </th>
        <td mat-cell *matCellDef="let child"> {{child.grade}} </td>
      </ng-container>

      <ng-container matColumnDef="school">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> School </th>
        <td mat-cell *matCellDef="let child"> {{child.school}} </td>
      </ng-container>

      <ng-container matColumnDef="center">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Center </th>
        <td mat-cell *matCellDef="let child"> {{child.center}} </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
        <td mat-cell *matCellDef="let child"> {{child.status}} </td>
      </ng-container>

      <ng-container matColumnDef="attendance">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Attendance </th>
        <td mat-cell *matCellDef="let child">
          <app-attendance-block *ngFor="let att of attendanceList.get(child.pn)" [attendanceData]="att"></app-attendance-block>
        </td>
      </ng-container>


      <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
      <tr mat-row *matRowDef="let child; columns: columnsToDisplay" (click)="showChildDetails(child)" style="cursor:pointer;"></tr>
    </table>
  </div>


  <div fxFlexAlign="right">
    <mat-expansion-panel expanded="true">
      <mat-expansion-panel-header>
        <mat-panel-title>Details</mat-panel-title>
      </mat-expansion-panel-header>
      <mat-button-toggle-group name="columnSelection" vertical [(value)]="columnGroupSelection">
        <mat-button-toggle value="basic" (click)="displayColumnGroup('basic')">Basic Info</mat-button-toggle>
        <mat-button-toggle value="school" (click)="displayColumnGroup('school')">School</mat-button-toggle>
        <mat-button-toggle value="status" (click)="displayColumnGroup('status')">Status</mat-button-toggle>
      </mat-button-toggle-group>
    </mat-expansion-panel>

    <mat-expansion-panel expanded="true">
      <mat-expansion-panel-header>
        <mat-panel-title>Filters</mat-panel-title>
      </mat-expansion-panel-header>
      <mat-button-toggle-group name="filterSelection" vertical [(value)]="filterGroupSelection">
        <mat-button-toggle value="current" (click)="displayFilteredList('current')">Current</mat-button-toggle>
        <mat-button-toggle value="dropouts" (click)="displayFilteredList('dropouts')">Dropouts</mat-button-toggle>
      </mat-button-toggle-group>
    </mat-expansion-panel>
  </div>

</div>
