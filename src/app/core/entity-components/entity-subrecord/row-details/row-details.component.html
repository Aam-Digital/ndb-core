<app-dialog-close mat-dialog-close></app-dialog-close>
<div mat-dialog-content>
  <div class="main-content">
    <div
      *ngFor="let row of data.columns"
      class="flex-row align-baseline gap-small full-width"
    >
      <div class="flex-grow">
        <div
          [appDynamicComponent]="{
            component: row.edit,
            config: {
              formFieldConfig: row,
              propertySchema: data.entity.getSchema().get(row.id),
              formControl: form.get(row.id)
            }
          }"
        ></div>
      </div>
      <fa-icon
        (click)="tooltipElement.show()"
        #tooltipElement="matTooltip"
        *ngIf="row.tooltip"
        matSuffix
        icon="question-circle"
        [matTooltip]="row.tooltip"
      ></fa-icon>
    </div>
  </div>

  <div *ngFor="let col of viewOnlyColumns">
    <app-pill
      [matTooltip]="col.tooltip"
      [style.background-color]="tempEntity.getColor()"
      class="mat-body-strong"
    >
      <span *ngIf="col.label">{{ col.label }}:&nbsp;</span>
      <ng-template
        [appDynamicComponent]="{
        component: col.view,
        config: {
          id: col.id,
          entity: tempEntity,
          config: col.additional
        }
      }"
      ></ng-template>
    </app-pill>
    <!-- avoid scroll bar + move delete into [...] menu -->
  </div>
</div>
<div mat-dialog-actions>
  <button
    mat-raised-button
    (click)="save()"
    [disabled]="form.disabled"
    i18n="Save button for forms"
  >
    Save
  </button>

  <button
    *ngIf="editMode === 'update'"
    mat-icon-button
    [matMenuTriggerFor]="additional"
  >
    <fa-icon icon="ellipsis-v" class="standard-icon"></fa-icon>
  </button>
  <mat-menu
    #additional
  >
    <button
      mat-menu-item
      (click)="delete()"
      *appDisabledEntityOperation="{
        operation: 'delete',
        entity: data.entity
      }"
      angulartics2On="click"
      [angularticsCategory]="data.entity.getType()"
      angularticsAction="entity_delete"
    >
      <fa-icon
        class="standard-icon-with-text color-accent"
        aria-label="remove element"
        icon="trash"
      ></fa-icon>
      <span i18n="Generic delete button"> Delete </span>
    </button>
  </mat-menu>
</div>
