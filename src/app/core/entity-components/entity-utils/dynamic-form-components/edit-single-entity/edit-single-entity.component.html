<mat-form-field *ngIf="!selectedEntity || editingSelectedEntity" [formGroup]="formControl.parent">
  <mat-label>{{ label }}</mat-label>
  <input
    #inputElement
    matInput
    [fxHide]="!formControl.enabled"
    [placeholder]="placeholder"
    [formControl]="entityNameFormControl"
    [matAutocomplete]="autoSuggestions"
    (keyup.enter)="select(entityNameFormControl.value)"
    (focusout)="select(entityNameFormControl.value)"
  />
  <mat-autocomplete
    #autoSuggestions="matAutocomplete"
    (optionSelected)="select($event.option.value)"
  >
    <!-- Optional header -->
    <ng-content select="mat-option"></ng-content>
    <mat-option *ngFor="let entity of filteredEntities | async" [value]="entity.toString()">
      <app-display-entity
        [entityToDisplay]="entity"
        [linkDisabled]="true"
      ></app-display-entity>
    </mat-option>
  </mat-autocomplete>
  <mat-error *ngIf="formControl.errors?.required" i18n="Error message for any input">
    This field is required
  </mat-error>
</mat-form-field>

<div *ngIf="selectedEntity && !editingSelectedEntity" style="margin-top: 7px">
  <app-display-entity
    class="block-wrapper"
    [entityToDisplay]="selectedEntity"
    [linkDisabled]="true"
  ></app-display-entity>
  <button mat-icon-button (click)="editSelectedEntity()">
    <fa-icon icon="edit"></fa-icon>
  </button>
</div>
