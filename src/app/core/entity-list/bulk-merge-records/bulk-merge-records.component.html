<mat-dialog-content>
  <form [formGroup]="mergeForm">
    <div class="merge-grid">
      <div class="header">Labels</div>
      <div class="header">Record A</div>
      <div class="header">Record B</div>
      <div class="header">Merge Preview</div>

      <ng-container *ngFor="let field of mergeFields">
        <div class="label-cell">
          <strong>{{ field.label }}</strong>
        </div>

        <div class="record-cell">
          <mat-radio-group
            [formControlName]="field.key"
            (change)="mergeForm.get(field.key)?.setValue($event.value)"
          >
            <mat-radio-button [value]="entitiesToMerge[0][field.key]">
              {{
                entitiesToMerge[0][field.key]?.label ||
                  entitiesToMerge[0][field.key]
              }}
            </mat-radio-button>
          </mat-radio-group>
        </div>

        <div class="record-cell">
          <mat-radio-group
            [formControlName]="field.key"
            (change)="mergeForm.get(field.key)?.setValue($event.value)"
          >
            <mat-radio-button [value]="entitiesToMerge[1][field.key]">
              {{
                entitiesToMerge[1][field.key]?.label ||
                  entitiesToMerge[1][field.key]
              }}
            </mat-radio-button>
          </mat-radio-group>
        </div>

        <!-- Merge Preview -->
        <div class="preview-cell">
          {{
            mergeForm.get(field.key)?.value?.label ||
              mergeForm.get(field.key)?.value ||
              "No Selection"
          }}
        </div>
      </ng-container>
    </div>
  </form>
</mat-dialog-content>

<mat-dialog-actions>
  <button mat-raised-button (click)="cancel()" i18n>Cancel</button>
  <button
    mat-raised-button
    color="accent"
    (click)="merge()"
    [disabled]="mergeForm.invalid"
    i18n
  >
    Merge
  </button>
</mat-dialog-actions>
