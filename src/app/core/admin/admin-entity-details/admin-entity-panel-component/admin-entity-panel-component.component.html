<div class="padding-regular">
  @if (targetEntityType?.ENTITY_TYPE) {
    <mat-form-field appearance="fill" class="margin-bottom-regular">
      <mat-label i18n>Entity Type</mat-label>
      <app-entity-type-select
        [(ngModel)]="entityTypeModel"
        (ngModelChange)="onEntityTypeChange($event)"
        [multi]="false"
        [showInternalTypes]="true"
      ></app-entity-type-select>
    </mat-form-field>

    <div class="margin-top-regular hint-text">
      <p i18n>
        Select which fields should be visible in this panel. You can also
        reorder them to control their display sequence.
      </p>
    </div>

    <app-reorderable-list
      [items]="activeFields"
      [availableItems]="allFields"
      [entityType]="targetEntityType"
      [orientation]="'mixed'"
      [itemTemplate]="fieldTemplate"
      [fieldLabel]="'Columns shown:'"
      (itemsChange)="updateFields($event)"
    ></app-reorderable-list>

    <ng-template #fieldTemplate let-field let-remove="remove">
      <div class="drop-item column-preview flex-row gap-small">
        <fa-icon icon="grip-vertical" class="drag-handle"></fa-icon>
        <app-entity-field-label
          [field]="field"
          [entityType]="targetEntityType"
        ></app-entity-field-label>
        <fa-icon
          icon="times"
          class="remove-icon"
          (click)="remove(field)"
        ></fa-icon>
      </div>
    </ng-template>
  } @else {
    <p>[ {{ config.component }} ]</p>

    <p class="hint-text" i18n>
      Editing advanced sub-sections is not supported yet in this preview.
    </p>
  }
</div>
